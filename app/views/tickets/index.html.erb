<%= render partial: "events/tabs" %>

<div class="row">
  <div class="col-sm-12">
    <h3>Registrations</h3>
    <%= render partial: 'flash' %>
    <%= link_to raw('<i class="glyphicon glyphicon-filter"></i> Filter registrations'), '#', class: 'btn btn-default', 'data-toggle' => 'modal', 'data-target' => '#filter-modal' %>
    <%= link_to raw('<i class="glyphicon glyphicon-envelope"></i> Send email'), '#', class: 'btn btn-default', 'data-toggle' => 'modal', 'data-target' => '#mail-modal' %>
    <span id="export-link">
      <%= render 'events/export' %>
    </span>
    <%= tag :span, id: "export_status_url", data: {url: export_status_event_path(@event)} %>
    <span class="pull-right btn btn-default"><strong>Total registrations:</strong> <%= @event.tickets.size %></span>

    <br />
    <br />

    <% if @tickets.blank? %>
      <div class="alert alert-warning alert-dismissable">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <strong>Warning!</strong> No registrations found. If you have set any filters, you can
        <%= link_to "reset", event_tickets_path(@event) %> these.
      </div>
    <% else %>
      <%= bootstrap_pagination @tickets %>
      <table class="table table-striped table-hover" id="table-tickets">
        <%= datagrid_header @ticketsgrid %>
        <%= datagrid_rows @ticketsgrid, @tickets %>
      </table>
      <%= bootstrap_pagination @tickets %>
    <% end %>
  </div>
</div>


<%= render partial: 'tickets/email_modal' %>
<%= render partial: 'tickets/info_modal' %>
<%= render partial: 'tickets/filter_modal' %>
